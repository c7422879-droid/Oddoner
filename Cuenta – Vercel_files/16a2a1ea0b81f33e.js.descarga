;!function(){try { var e="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof global?global:"undefined"!=typeof window?window:"undefined"!=typeof self?self:{},n=(new e.Error).stack;n&&((e._debugIds|| (e._debugIds={}))[n]="87a64fcb-23a4-4199-f028-121c9d97d69d")}catch(e){}}();
(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,4149332,e=>{e.v({container:"multi-email-module__8cLfqq__container",list:"multi-email-module__8cLfqq__list"})},461376,e=>{"use strict";var t=e.i(7292788),i=e.i(7047540),l=e.i(5140444),s=e.i(4670733),a=e.i(8583659),n=e.i(4585051),r=e.i(2504781),o=e.i(6881349),d=e.i(7137884),c=e.i(5063443),u=e.i(8517043),m=e.i(1232681),h=e.i(3895030),x=e.i(9792418),f=e.i(455575),j=e.i(277234),p=e.i(4244280),y=e.i(1434061),g=e.i(7917902),b=e.i(57106),v=e.i(5807088);let T=(0,a.memo)(function(){let{user:e,isLoading:i,mutate:l,teams:s,isNorthstar:T}=(0,g.useAccount)(),[C,w]=(0,a.useState)(e?.defaultTeamId),[S,N]=(0,a.useState)(""),[A,I]=(0,a.useState)(!1);(0,a.useEffect)(()=>{w(e?.defaultTeamId)},[e?.defaultTeamId]);let E=(0,a.useCallback)(e=>{e&&w(e)},[]),k=(0,a.useCallback)(()=>{S&&N(""),I(!0),(0,j.fetchAPI)(p.API_USER,{method:"PATCH",body:{defaultTeamId:C},throwOnHTTPError:!0}).then(l).then(y.jwtKVStoreInitializeFetch).then(()=>{f.toasts.success("Your Default Team has been updated.")}).catch(e=>{e instanceof Error?N(e.message):N("An unknown error occurred. Please try again.")}).finally(()=>{I(!1)})},[S,l,C]);return i||!e?(0,t.jsx)(v.default,{height:81}):T?(0,t.jsxs)(u.Fieldset,{children:[(0,t.jsxs)(d.FieldsetContent,{children:[(0,t.jsx)(x.FieldsetTitle,{children:"Default Team"}),(0,t.jsx)(h.FieldsetSubtitle,{children:"Your default team will be used when you make a request through the API or CLI where you don’t specify a particular team. It will also be the team selected when you first navigate to the dashboard."}),(0,t.jsx)("div",{className:"flex flex-row items-stretch justify-start gap-2 flex-initial",children:(0,t.jsxs)(o.Combobox,{onChange:E,placeholder:"Find Team…",value:C,width:300,children:[(0,t.jsx)(o.Combobox.Input,{}),(0,t.jsx)(o.Combobox.List,{children:s?.map(e=>(0,t.jsx)(o.Combobox.Option,{prefix:(0,t.jsx)(n.Avatar,{hash:e.avatar,size:24,teamId:e.id}),value:e.id,children:e.slug},e.id))})]})})]}),(0,t.jsxs)(m.FieldsetFooter,{children:[(0,t.jsx)(m.FieldsetFooter.Status,{children:S?(0,t.jsx)(c.ErrorText,{children:S}):(0,t.jsxs)("span",{children:["Learn more about"," ",(0,t.jsx)(b.Link,{external:!0,href:"/docs/accounts#default-team",type:"highlight",children:"Default Teams"})]})}),(0,t.jsx)(m.FieldsetFooter.Actions,{children:(0,t.jsx)(r.Button,{disabled:!C||e.defaultTeamId===C,loading:A,onClick:k,size:"small",children:"Save"})})]})]}):null});var C=e.i(5468328),w=e.i(6198010),S=e.i(1114103),N=e.i(8436238),A=e.i(8522445),I=e.i(4004502),E=e.i(8248823);function k(e,t,i){return async()=>{let l=await (0,j.fetchAPI)(p.API_USER_EMAILS,{method:e,body:{email:t},throwOnHTTPError:!0});return{...i,user:i.user&&{...i.user,...l}}}}var F=e.i(5484396),P=e.i(4787360),M=e.i(3500331),O=e.i(3671642),L=e.i(6891161),_=e.i(8522580),D=e.i(3869281),U=e.i(6734680),R=e.i(7722264),B=e.i(5169576),z=e.i(3754279);function V(e){let{isOpen:i,setIsOpen:l,onAddEmail:s}=e,[n,r]=(0,a.useState)(""),[o,d]=(0,a.useState)(null),[c,u]=(0,a.useState)(!1),[m,h]=(0,a.useState)(!1),x=async()=>{if(!(0,U.default)(n))return void d({message:"Please enter a valid email address."});if(!m)return void d({message:"Please confirm that you understand that this email will have access to your account."});d(null),u(!0);try{await s(n),u(!1)}catch(l){var e,i;u(!1),d((e=l,i=n,(0,R.isError)(e)&&"code"in e&&"duplicated"===e.code?{message:"An account already exists with this email. Please remove this email from the other account, or delete the other account. Any existing resources you wish to keep must be transferred before the account deletion.",action:(0,t.jsx)($,{email:i}),type:"secondary",fill:!0}:{message:(0,E.errorToString)(e)}));return}l(!1),r(""),h(!1)},f=()=>{l(!1),d(null)};return(0,t.jsxs)(L.Modal,{active:i,onClickOutside:f,onEnterKeyPress:()=>{x()},children:[(0,t.jsxs)(L.Modal.Body,{children:[(0,t.jsxs)(L.Modal.Header,{children:[(0,t.jsx)(L.Modal.Title,{children:"Add Email"}),(0,t.jsx)(L.Modal.Subtitle,{children:"Add a new email address to your account. This email, once verified, can be used to login to your account."})]}),(0,t.jsxs)("div",{className:"flex flex-col items-stretch justify-start gap-4 flex-initial",children:[(0,t.jsx)(O.Label,{value:"Email",children:(0,t.jsx)(M.Input,{id:"add-new-entry",onChange:e=>{r(e.target.value.toLowerCase()),d(null)},placeholder:"user@acme.com"})}),(0,t.jsxs)(D.Checkbox,{checked:m,onChange:()=>h(!m),children:["I understand that this email will have access to my account"," ",(0,t.jsx)(C.Tooltip,{cursor:"pointer",style:{transform:"translateY(2px)"},text:"Anyone with access to this email address will have access to your account.",children:(0,t.jsx)(B.Information,{})})]}),o?(0,t.jsx)(_.Note,{action:o.action,fill:o.fill,type:o.type||"error",children:o.message}):null]})]}),(0,t.jsxs)(L.Modal.Actions,{children:[(0,t.jsx)(L.Modal.Action,{onClick:f,type:"secondary",children:"Cancel"}),(0,t.jsx)(L.Modal.Action,{"data-testid":(0,I.tid)("account","add-email-modal","save-button"),disabled:!m||!n,loading:c,onClick:x,children:"Save"})]})]})}function $(e){let{email:i}=e,l=(0,z.useLogout)();return(0,t.jsx)(C.Tooltip,{desktopOnly:!0,text:`Log out and login via email with ${i}`,children:(0,t.jsx)(r.Button,{onClick:()=>{l({source:"logout-to-remove-duplicate-email",next:`/login/email?email=${encodeURIComponent(i)}&next=${encodeURIComponent("/account/general#email")}`,redirectType:"redirect-to-next-after-logout"})},size:"small",children:"Switch accounts"})})}function q(e){let{email:i,isOpen:l,setIsOpen:s,onDeleteEmail:a}=e,n=()=>{s(!1),a()};return(0,t.jsxs)(L.Modal,{active:l,onClickOutside:()=>s(!1),onEnterKeyPress:n,children:[(0,t.jsx)(L.Modal.Body,{children:(0,t.jsxs)(L.Modal.Header,{children:[(0,t.jsx)(L.Modal.Title,{children:"Delete Email"}),(0,t.jsxs)(L.Modal.Subtitle,{children:["Are you sure you want to remove ",(0,t.jsx)("strong",{children:i})," from your account?"]})]})}),(0,t.jsxs)(L.Modal.Actions,{children:[(0,t.jsx)(L.Modal.Action,{onClick:()=>s(!1),type:"secondary",children:"Cancel"}),(0,t.jsx)(L.Modal.Action,{onClick:n,children:"Confirm"})]})]})}var G=e.i(3306538),H=e.i(779588),Y=e.i(2064047),K=e.i(8459493);function W(e){let{email:i,verified:l,primary:s,onDelete:n,onSetPrimary:o}=e,{resendVerificationEmail:d,isSendingVerificationEmail:c}=function(){let[e,i]=(0,a.useState)(!1);return{resendVerificationEmail:async e=>{i(!0);let l=await (0,j.fetchAPI)(p.API_USER_VERIFY_EMAIL,{method:"POST",body:{email:e},returnStatus:!0});"object"==typeof l.body&&"error"in l.body?"rate_limited"===l.body.error.code?f.toasts.error({text:(0,t.jsxs)("div",{className:"flex flex-col items-stretch justify-start gap-4 flex-initial",children:[(0,t.jsx)("p",{className:"text-[14px] leading-[20px] font-medium",children:"Too many requests"}),(0,t.jsxs)("p",{className:"text-copy-14",children:["Please check your email"," ",(0,t.jsx)("span",{className:"text-[14px] leading-[20px] font-medium",style:{wordBreak:"break-all"},children:e})," ","for the verification link to continue."]})]})}):f.toasts.error({text:(0,t.jsxs)("div",{className:"flex flex-col items-stretch justify-start gap-4 flex-initial",children:[(0,t.jsx)("p",{className:"text-[14px] leading-[20px] font-medium",children:"Unable to send verification email"}),(0,t.jsxs)("p",{className:"text-copy-14",children:["An error occurred while sending the verification email to"," ",(0,t.jsx)("span",{className:"text-[14px] leading-[20px] font-medium",style:{wordBreak:"break-all"},children:e}),"."]})]})}):f.toasts.message({text:(0,t.jsxs)("div",{className:"flex flex-col items-stretch justify-start gap-4 flex-initial",children:[(0,t.jsx)("p",{className:"text-[14px] leading-[20px] font-medium",children:"Verification email sent"}),(0,t.jsxs)("p",{className:"text-copy-14",children:["Follow the verification link sent to"," ",(0,t.jsx)("span",{className:"text-[14px] leading-[20px] font-medium",children:e})," ","to continue."]})]})}),i(!1)},isSendingVerificationEmail:e}}();return(0,t.jsx)(Y.Entity,{as:"span",className:"tailwind-preflight","data-testid":(0,I.tid)("account","emails",i),left:(0,t.jsxs)("div",{className:"flex flex-col lg:flex-row items-stretch justify-start gap-0.5 lg:gap-2 flex-initial",children:[i,(0,t.jsxs)("div",{className:"flex flex-row items-start justify-start gap-1 flex-initial",children:[(0,t.jsx)(G.Badge,{size:"md",variant:l?"blue-subtle":"gray-subtle",children:l?"Verified":"Unverified"}),s?(0,t.jsx)(G.Badge,{size:"md",variant:"green-subtle",children:"Primary"}):null]})]}),right:(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(S.AnimatePresence,{initial:!1,children:l?null:(0,t.jsx)(N.motion.span,{animate:{opacity:1},exit:{opacity:0},transition:{opacity:{duration:.2}},children:(0,t.jsx)(r.Button,{className:"geist-hide-on-mobile",loading:c,onClick:()=>void d(i),size:"small",type:"secondary",children:"Resend verification email"})})}),(0,t.jsxs)(H.DotsMenu,{children:[s?null:(0,t.jsx)(C.Tooltip,{disableTriggers:l,style:{width:"100%"},text:"Unverified emails cannot be set as primary.",children:(0,t.jsx)(K.MenuItem,{disabled:!l,onClick:()=>o(i),children:"Set as primary"})}),l?null:(0,t.jsx)("li",{className:"geist-show-on-mobile geist-hide-on-desktop",children:(0,t.jsx)(K.MenuItem,{disabled:c,onClick:()=>void d(i),children:"Resend verification email"})}),(0,t.jsx)(C.Tooltip,{disableTriggers:!s,style:{width:"100%"},text:"Your primary email cannot be deleted.",children:(0,t.jsx)(K.MenuItem,{disabled:s,onClick:()=>n(i),type:"error",children:"Delete"})})]})]})},i)}var J=e.i(4149332);function Q(e){let{user:t,includeUnverified:i}=e,l=[{email:t.email,verified:!0,primary:!0},...t.secondaryEmails?.map(e=>{let{email:t,verified:i}=e;return{email:t,verified:i,primary:!1}})??[]];return i?l:l.filter(e=>e.verified)}let X=P.PERSONAL_ACCOUNT_SETTINGS_NAVIGATION_TITLES.general.email;function Z(){let[e,i]=(0,a.useState)(!1),[s,n]=(0,a.useState)(!1),[o,c]=(0,a.useState)(""),{user:j}=(0,g.useAccount)(),{addEmail:p,deleteEmail:y,setPrimaryEmail:b}=function(){let{data:e,mutate:i}=(0,l.useUser)(),s=(0,a.useCallback)(async l=>{if(e?.user){if(e.user.email.toLowerCase()===l||e.user.secondaryEmails?.find(e=>e.email===l))throw Error("This email is already added.");await i(k("POST",l,e),{populateCache:!0,revalidate:!1}),f.toasts.message({text:(0,t.jsxs)("div",{className:"flex flex-col items-stretch justify-start gap-4 flex-initial",children:[(0,t.jsx)("p",{className:"text-[14px] leading-[20px] font-medium",children:"Verify your email"}),(0,t.jsxs)("p",{className:"text-copy-14",children:["Follow the verification link sent to"," ",(0,t.jsx)("span",{className:"text-[14px] leading-[20px] font-medium",children:l})," ","to continue."]})]})})}},[i,e]);return{addEmail:s,deleteEmail:(0,a.useCallback)(async t=>{if(e?.user)try{await i(k("DELETE",t,e),{optimisticData:{...e,user:{...e.user,secondaryEmails:e.user.secondaryEmails?.filter(e=>{let{email:i}=e;return i!==t})}},rollbackOnError:!0,populateCache:!0,revalidate:!1})}catch(e){f.toasts.error((0,E.errorToString)(e))}},[i,e]),setPrimaryEmail:(0,a.useCallback)(async t=>{if(!e?.user)return;let l=e.user.email;try{await i(k("PATCH",t,e),{optimisticData:{...e,user:{...e.user,email:t,secondaryEmails:e.user.secondaryEmails?.map(e=>e.email===t?{email:l,verified:!0}:e)}},rollbackOnError:!0,populateCache:!0,revalidate:!1})}catch(e){f.toasts.error((0,E.errorToString)(e))}},[i,e])}}(),[T,{height:P}]=(0,A.default)();if(!j)return(0,t.jsx)(v.default,{height:175});let M=Q({user:j,includeUnverified:!0}),O=M.length>=10;return(0,t.jsx)(F.default,{className:"tailwind-preflight",children:(0,t.jsxs)(u.Fieldset,{children:[(0,t.jsxs)(d.FieldsetContent,{children:[(0,t.jsx)(x.FieldsetTitle,{id:X,children:X}),(0,t.jsx)(h.FieldsetSubtitle,{children:"Enter the email addresses you want to use to log in with Vercel. Your primary email will be used for account-related notifications."}),(0,t.jsxs)("div",{className:"flex flex-col items-stretch justify-start gap-6 flex-initial pt-2",children:[(0,t.jsx)(N.motion.div,{animate:{height:P},className:J.default.container,initial:{height:`${64*M.length}px`},children:(0,t.jsx)("ul",{className:J.default.list,ref:T,children:(0,t.jsx)(S.AnimatePresence,{initial:!1,children:M.map(e=>(0,t.jsx)(N.motion.li,{animate:{opacity:1},exit:{opacity:0},initial:{opacity:0},transition:{opacity:{duration:.7}},children:(0,t.jsx)(W,{...e,onDelete:e=>{c(e),n(!0)},onSetPrimary:e=>{b(e)}})},e.email))})})}),(0,t.jsxs)("div",{className:"flex flex-col items-start justify-start flex-initial",children:[(0,t.jsx)(V,{isOpen:e,onAddEmail:p,setIsOpen:i}),(0,t.jsx)(q,{email:o,isOpen:s,onDeleteEmail:()=>{y(o),c("")},setIsOpen:n}),(0,t.jsx)(C.Tooltip,{text:O?"Maximum 10 emails":void 0,children:(0,t.jsx)(r.Button,{"data-testid":(0,I.tid)("account","add-email-button"),disabled:O,onClick:()=>i(!0),prefix:(0,t.jsx)(w.Plus,{}),size:"small",type:"secondary",children:"Add Another"})})]})]})]}),(0,t.jsx)(m.FieldsetFooter,{children:(0,t.jsx)(m.FieldsetFooter.Status,{children:"Emails must be verified to be able to login with them or be used as primary email."})})]})})}var ee=e.i(192211),et=e.i(5723590),ei=e.i(5338940),el=e.i(9095583),es=e.i(1438473),ea=e.i(7957251);function en(e){let{emails:i,primaryEmail:l,highlightErrors:s,isDeleteDisabled:d,onChange:c,onDelete:u,route:m,teamIdsInUse:h,teams:x}=e,[f,j]=(0,a.useState)(""),[p,y]=(0,a.useState)(""),g=x.find(e=>e.id===m.teamId),b=x.filter(e=>!h.includes(e.id)||e.id===g?.id).filter(e=>e.name.toLowerCase().includes(f.toLowerCase())),v=i.filter(e=>e.toLowerCase().includes(p.toLowerCase()));return(0,t.jsxs)("div",{className:"flex w-full flex-col gap-2 md:flex-row md:gap-4",children:[(0,t.jsxs)("div",{className:"w-full gap-2 md:flex md:w-1/2",children:[(0,t.jsx)(O.Label,{value:"Team",wrapperClassName:"md:hidden"}),(0,t.jsxs)("div",{className:"row flex w-full gap-4",children:[(0,t.jsxs)(o.Combobox,{className:"w-full",errored:!!s&&!g,onChange:e=>{j(""),c({...m,teamId:e})},onClear:()=>{j("")},placeholder:"Select team…",value:m.teamId,children:[(0,t.jsx)(o.Combobox.Input,{onChange:e=>{j(e.target.value)},onKeyDown:e=>{"Escape"===e.key&&(e.preventDefault(),j(""))}}),(0,t.jsx)(o.Combobox.List,{className:"tailwind-preflight",children:b.map(e=>(0,t.jsx)(o.Combobox.Option,{label:e.name,prefix:(0,t.jsx)(n.Avatar,{hash:e.avatar,size:20}),value:e.id,children:e.name},e.id))})]}),(0,t.jsx)("div",{className:"md:auto invisible w-8 flex-col items-center justify-center md:visible md:flex md:w-auto",children:(0,t.jsx)(es.ArrowRight,{})})]})]}),(0,t.jsxs)("div",{className:"w-full gap-2 md:flex md:w-1/2",children:[(0,t.jsx)(O.Label,{value:"Email",wrapperClassName:"md:hidden"}),(0,t.jsxs)("div",{className:"row flex w-full gap-2",children:[(0,t.jsxs)(o.Combobox,{className:"w-full",errored:!!s&&!m.email,onChange:e=>{y(""),c({...m,email:e})},onClear:()=>{y("")},placeholder:"Select email…",value:m.email,children:[(0,t.jsx)(o.Combobox.Input,{onChange:e=>{y(e.target.value)},onKeyDown:e=>{"Escape"===e.key&&(e.preventDefault(),y(""))}}),(0,t.jsx)(o.Combobox.List,{className:"tailwind-preflight",children:v.map(e=>(0,t.jsx)(o.Combobox.Option,{label:e,suffix:e===l?(0,t.jsx)(G.Badge,{size:"md",variant:"green-subtle",children:"Primary"}):null,value:e,children:e},e))})]}),(0,t.jsx)("div",{className:"md:auto flex w-8 flex-col justify-center md:w-auto",children:(0,t.jsx)(r.Button,{"aria-label":"Remove route",disabled:d,onClick:u,shape:"circle",size:"small",style:{border:"none",background:"none"},svgOnly:!0,type:"tertiary",children:(0,t.jsx)(ea.MinusCircle,{})})})]})]})]})}let er=P.PERSONAL_ACCOUNT_SETTINGS_NAVIGATION_TITLES.general.emailRouting;function eo(){let e=(0,f.useToasts)(),[i,s]=(0,a.useTransition)(),[n,o]=(0,a.useState)([]),[c,y]=(0,a.useState)(!1),[g,T]=(0,a.useState)(null),[k,{height:P}]=(0,A.default)(),[M,{height:L}]=(0,A.default)(),{data:_,isLoading:D,mutate:U}=(0,el.useEmailNotifications)(),R=(0,ei.useSortedTeams)(),{user:B}=(0,l.useUser)();(0,a.useEffect)(()=>{if(!D&&_?.rules){if(0===Object.entries(_.rules).length)return void o([{teamId:1===R.length?R[0].id:null,email:null}]);o(Object.entries(_.rules).map(e=>{let[t,i]=e;return{teamId:t,email:i?.email??null}}))}},[D,_,R]);let z=1===n.length&&!n[0].teamId&&!n[0].email,V=e=>{let t=Object.entries(_?.rules??{}).map(e=>{let[t,i]=e;return{teamId:t,email:i?.email??null}});return!(0,et.default)(t,e)};if(D||!R.length||!B)return(0,t.jsx)(v.default,{height:158});let $=Q({user:B}).map(e=>{let{email:t}=e;return t}),q=n.map(e=>e.teamId).filter(Boolean),G=R.filter(e=>!q.includes(e.id));return(0,t.jsx)(F.default,{className:"tailwind-preflight",children:(0,t.jsxs)(u.Fieldset,{children:[(0,t.jsxs)(d.FieldsetContent,{children:[(0,t.jsx)(x.FieldsetTitle,{children:er}),(0,t.jsx)(h.FieldsetSubtitle,{children:"Route team notifications to specific email addresses. The default for every team is your primary email."}),(0,t.jsxs)("div",{className:"flex flex-col gap-4 pt-2",children:[(0,t.jsxs)(N.motion.div,{animate:{height:L+P},initial:{height:`${48*n.length}px`},children:[(0,t.jsxs)("div",{className:"md:row hidden w-full gap-4 md:flex",ref:M,children:[(0,t.jsx)(O.Label,{value:"Team",wrapperClassName:"w-1/2"}),(0,t.jsx)(O.Label,{value:"Email",wrapperClassName:"w-1/2"})]}),(0,t.jsx)("ul",{ref:k,children:(0,t.jsx)(S.AnimatePresence,{initial:!1,children:n.map((e,i)=>(0,t.jsxs)(N.motion.li,{animate:{opacity:1},className:"pb-2",exit:{opacity:0},initial:{opacity:0},transition:{opacity:{duration:.7}},children:[i>0?(0,t.jsx)("div",{className:"py-4 md:hidden",children:(0,t.jsx)(ee.Divider,{})}):null,(0,t.jsx)(en,{emails:$,highlightErrors:null!==g,isDeleteDisabled:z,onChange:e=>{let t=n.map((t,l)=>l===i?e:t);o(t),y(V(t)),T(null)},onDelete:()=>{let e=n.filter((e,t)=>t!==i),t=e.length?e:[{teamId:null,email:null}];o(t),y(V(t)),T(null)},primaryEmail:B.email,route:e,teamIdsInUse:q,teams:R})]},`key_${i}`))})})]}),(0,t.jsx)("div",{children:(0,t.jsx)(C.Tooltip,{disableTriggers:n.length<R.length,text:"You can only add as many email routes as you have teams.",children:(0,t.jsx)(r.Button,{"data-testid":(0,I.tid)("account","add-email-button"),disabled:n.length===R.length,onClick:()=>{let e=[...n,{teamId:1===G.length?G[0].id:null,email:null}];o(e),y(V(e)),T(null)},prefix:(0,t.jsx)(w.Plus,{}),size:"small",type:"secondary",children:"Add Another"})})})]})]}),(0,t.jsxs)(m.FieldsetFooter,{children:[(0,t.jsx)(m.FieldsetFooter.Status,{children:(0,t.jsxs)("p",{className:"text-copy-14 text-inherit",children:["Learn more about"," ",(0,t.jsx)(b.Link,{external:!0,href:"/docs/accounts",type:"highlight",children:"Email Routing"})]})}),(0,t.jsx)(m.FieldsetFooter.Actions,{children:(0,t.jsx)(r.Button,{disabled:!c||i,onClick:()=>{s(async()=>{if(!n.every(e=>!!(e.teamId&&e.email))&&!z){T("Please fill out all fields, or remove empty routes."),y(!1);return}try{await (0,j.fetchAPI)(p.API_NOTIFICATION_RULES,{method:"POST",body:{rules:n.filter(e=>{let{teamId:t,email:i}=e;return t&&i}).map(e=>({teamId:e.teamId,email:e.email}))},throwOnHTTPError:!0}),await U(),y(!1),e.success("Email routing settings saved.")}catch(t){e.error((0,E.errorToString)(t))}})},size:"small",children:"Save"})})]})]})})}var ed=e.i(8111190),ec=e.i(4965818),eu=e.i(3995351),em=e.i(2953410),eh=e.i(6637390),ex=e.i(512540),ef=e.i(9318197),ej=e.i(6352514),ep=e.i(4759942),ey=e.i(9070994),eg=e.i(1574218),eb=e.i(9544652),ev=e.i(2020034),eT=e.i(5819220),eC=e.i(979715),ew=e.i(4712634),eS=e.i(8933976),eN=e.i(1033625);e.i(1585898);var eA=e.i(2066827);let eI={surveyName:"Delete Personal Account User Feedback",surveySlug:"delete-personal-account-user-feedback",surveySteps:[{title:`You are about to queue your ${eg.PRODUCT} account for deletion. Before you go, please give feedback on why you're deleting your account.`,fields:[{type:"select",id:"reasons-why",label:"Why are you deleting your account?",selectMultiple:!0,options:[{id:"missing-features",label:"Missing features I need"},{id:"other-account",label:"I have another account"},{id:"switching",label:"Switching to another product"},{id:"unsatisfied",label:"Unsatisfied with performance"},{id:"other",label:"Other (please explain below)",reveals:{id:"other-specific"}}]}]},{title:"What was the primary reason you decided to stop using Vercel?",fields:[{type:"select",id:"reasons-why-stopped",label:"What was the primary reason you decided to stop using Vercel?",selectMultiple:!0,options:[{id:"high-cost",label:"High cost"},{id:"lack-of-necessary-features",label:"Lack of necessary features"},{id:"performance-issues",label:"Performance issues"},{id:"integration-challenges",label:"Integration challenges"},{id:"poor-customer-support",label:"Poor customer support"},{id:"better-alternative",label:"Found a better alternative"},{id:"project-requirements-changed",label:"Project requirements changed"},{id:"other",label:"Other (please explain below)",reveals:{id:"other-specific"}}]}]}]};function eE(e){let{onAbort:i,onDelete:l,active:s,wasQueued:a,onConfirm:n,dataTestIdContext:r}=e,o=async e=>{let{reasons:t}=(0,eN.transform)(e);await l(t)};return a?(0,t.jsxs)(L.Modal.Modal,{active:s,"data-testid":(0,I.tid)("account","delete-account-modal","confirm-link"),onClickOutside:i,children:[(0,t.jsxs)(L.Modal.Body,{children:[(0,t.jsxs)("div",{className:"flex flex-col items-start justify-start gap-6 flex-initial mb-6",children:[(0,t.jsx)(L.Modal.Title,{children:"Delete Personal Account"}),(0,t.jsx)(L.Modal.Subtitle,{children:"We have sent you an email with a confirmation link. To delete your account permanently, please confirm your decision by clicking the link in the email."})]}),(0,t.jsx)(L.Modal.Subtitle,{children:"Until confirmation, your account will continue to work uninterrupted."})]}),(0,t.jsx)(L.Modal.Actions,{children:(0,t.jsx)(L.Modal.Action,{fullWidth:!0,onClick:n,children:"OK"})})]}):(0,t.jsx)(eA.SurveyModal,{active:s,dataTestIdContext:r,onDismiss:()=>i(void 0),onSubmit:o,setActive:()=>void 0,showThankYouToast:!1,surveyInfo:eI})}let ek="delete my personal account";function eF(e){let{disabled:i,...s}=e,{teams:n,isReady:o}=(0,ei.useTeam)(),{user:c}=(0,l.useUser)(),f=n?.length,[j,y]=(0,a.useState)(!1),[g,b]=(0,a.useState)(!1),[T,w]=(0,a.useState)(!1),[S,N]=(0,a.useState)(!1),[A,E]=(0,a.useState)(null),[k,F]=(0,a.useState)(!1),[M,O]=(0,a.useState)(!1),L=(0,a.useMemo)(()=>ex.default.get("_user_delete_queued"),[]);M=M||L===c?.uid,(0,a.useEffect)(()=>{!f&&g&&(b(!1),w(!0))},[f,g]);let _=(0,a.useCallback)(async function(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];try{F(!0),await (0,ey.default)(p.API_USER+(t?"?resend=1":""),{method:"DELETE",body:JSON.stringify({reasons:e||[]})}),F("done"),setTimeout(()=>F(!1),3e3),c?.uid&&(0,ev.setCookie)("_user_delete_queued",c.uid,"365d"),O(!0)}catch(e){e instanceof Error&&(E(e),N(!1),y(!1))}},[c]),D=(0,a.useCallback)(async e=>{(!f||(0,eS.onlyTeamIsHobbyTeam)({user:c,teams:n}))&&(y(!0),ep.analytics.track(ej.AnalyticsEvent.DELETED_USER_ACCOUNT),await _(e),y(!1))},[f,c,n,_]);if(!o||!c||s.loading)return(0,t.jsx)(v.default,{height:66});let U=M&&(0,t.jsxs)(eb.DisabledContext.Provider,{value:!1,children:[(0,t.jsx)(ef.Spacer,{inline:!0,x:.5}),(0,t.jsx)("span",{className:"geist-disabled-skip geist-inline-center",children:(0,t.jsx)(C.Tooltip,{center:!1,delay:!1,padding:"var(--geist-gap)",position:"bottom",text:(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)("p",{className:"text-heading-14 m-0",children:"Awaiting Confirmation"}),(0,t.jsx)("p",{className:"text-copy-14",children:"We sent an email with a confirmation link, click the link to start the deletion process."}),(0,t.jsx)("p",{className:"text-copy-14",children:"Alternatively, request another confirmation email:"}),(0,t.jsx)(r.Button,{disabled:!!k,loading:!0===k,onClick:()=>void _(void 0,!0),width:"100%",children:"done"===k?"Resent":"Resend"})]}),children:(0,t.jsx)(G.Badge,{"data-testid":(0,I.tid)("account","delete-personal-account","awaiting-badge"),size:"md",variant:"blue",children:"Awaiting Confirmation"})})})]});return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsxs)(u.Fieldset,{"data-testid":(0,I.tid)("account","delete-personal-account"),disabled:i||M||c.limited,type:i||M||c.limited?"default":"error",children:[(0,t.jsxs)(d.FieldsetContent,{children:[(0,t.jsxs)(x.FieldsetTitle,{id:P.PERSONAL_ACCOUNT_SETTINGS_NAVIGATION_TITLES.general.delete,children:[P.PERSONAL_ACCOUNT_SETTINGS_NAVIGATION_TITLES.general.delete,U]}),M?(0,t.jsx)(h.FieldsetSubtitle,{children:"We have sent you an email with a confirmation link. To delete your account permanently, please confirm your decision by clicking the link in the email."}):(0,t.jsx)(h.FieldsetSubtitle,{children:"Permanently remove your Personal Account and all of its contents from the Vercel platform. This action is not reversible, so please continue with caution."})]}),(0,t.jsxs)(m.FieldsetFooter,{children:[A?(0,t.jsx)(m.FieldsetFooter.Status,{disabled:i,children:(0,t.jsx)(eL,{error:A})}):null,(0,t.jsx)(m.FieldsetFooter.Actions,{children:(0,t.jsx)(r.Button,{"data-testid":(0,I.tid)("account","delete-personal-account","delete-button"),loading:j,onClick:()=>{f&&!(0,eS.onlyTeamIsHobbyTeam)({user:c,teams:n})?b(!0):w(!0)},size:"small",type:"error",typeName:"button",children:"Delete Personal Account"})})]})]}),(0,t.jsx)(eM,{isActive:g,onAbort:()=>b(!1),teams:n,user:c}),(0,t.jsx)(eO,{isActive:T,isLoading:j,onAbort:()=>w(!1),onConfirm:()=>{w(!1),N(!0)},user:c}),(0,t.jsx)(eE,{active:S,dataTestIdContext:["settings-fieldset","delete-personal-account"],onAbort:()=>{O(!0),y(!1),D([])},onConfirm:()=>{N(!1),O(!0),y(!1),D([])},onDelete:D,wasQueued:M})]})}function eP(e){let{northstar:i,teams:l}=e,s=(0,a.useMemo)(()=>{if(!l)return[];let e=!1,s=[];for(let a of l){if(i&&a.billing?.plan==="hobby"&&!e){e=!0;continue}s.push((0,t.jsxs)(eT.Entity,{thumbnail:(0,t.jsx)(ew.EntityThumbnail,{size:24,children:(0,t.jsx)(n.Avatar,{size:24,teamId:a.id})}),children:[(0,t.jsx)(eC.EntityField,{title:a.name}),(0,t.jsx)(eC.EntityField,{description:(0,t.jsx)(b.Link,{href:`/${a.slug}/~/settings`,tab:!0,type:"highlight",children:"Settings"}),right:!0})]},a.slug))}return s},[i,l]);return(0,t.jsx)(t.Fragment,{children:s})}function eM(e){let{isActive:i,onAbort:l,user:s,teams:a}=e;return(0,t.jsxs)(L.Modal.Modal,{active:i,onClickOutside:l,width:480,children:[(0,t.jsxs)(L.Modal.Body,{children:[(0,t.jsx)(L.Modal.Title,{children:"Delete Personal Account"}),(0,t.jsx)(ef.Spacer,{}),(0,t.jsxs)(L.Modal.Subtitle,{children:["You have access to ",a?.length," teams. You must leave or delete",s?.version==="northstar"?" all of them except your Hobby team ":" them ","before you can delete your Personal Account."]}),(0,t.jsx)(ef.Spacer,{}),(0,t.jsx)(L.Modal.Inset,{last:!0,children:(0,t.jsx)(eP,{northstar:s?.version==="northstar",teams:a})})]}),(0,t.jsx)(L.Modal.Actions,{children:(0,t.jsx)(L.Modal.Action,{fullWidth:!0,onClick:l,children:"Cancel"})})]})}let eO=e=>{let{isActive:i,onAbort:l,isLoading:s,onConfirm:n,user:r}=e,[o,d]=(0,a.useState)(""),[c,u]=(0,a.useState)(""),[m,h]=(0,a.useState)(null),[x,f]=(0,a.useState)(null);return(0,t.jsx)(L.Modal.Modal,{active:i,"data-testid":(0,I.tid)("account","delete-confirm-modal"),onAnimationDone:()=>{h(null),f(null),d(""),u("")},onClickOutside:l,width:480,children:(0,t.jsxs)("form",{onSubmit:e=>{e.preventDefault(),h(null),f(null);let t=!1;o!==r.username&&(h(`The text you entered did not match "${r.username}".`),t=!0),c!==ek&&(f(`The text you entered did not match "${ek}".`),t=!0),t||n()},children:[(0,t.jsxs)(L.Modal.Body,{children:[(0,t.jsx)(L.Modal.Title,{children:"Delete Personal Account"}),(0,t.jsx)(ef.Spacer,{}),(0,t.jsxs)(L.Modal.Subtitle,{children:[(0,t.jsxs)(L.Modal.P,{children:[eg.PRODUCT," will ",(0,t.jsx)("b",{children:"delete all of your projects"}),", along with all of your deployments, domains, SSL certificates, activity, and all other resources belonging to your Personal Account."]}),(0,t.jsxs)(L.Modal.P,{children:[eg.PRODUCT," recommends that you transfer domains you wish to keep and remove ",eg.PRODUCT," Nameservers from all other domains."]})]}),(0,t.jsx)(ef.Spacer,{}),(0,t.jsx)(_.Note,{center:!0,fill:!0,label:!1,type:"error",variant:"contrast",children:"This action is not reversible. Please be certain."}),(0,t.jsx)(ef.Spacer,{}),(0,t.jsxs)(L.Modal.Inset,{last:!0,children:[(0,t.jsxs)("label",{children:[(0,t.jsxs)("p",{className:"text-copy-14 m-0",children:["Enter your username ",(0,t.jsx)("b",{children:r.username})," to continue:"]}),(0,t.jsx)(ef.Spacer,{y:1/4}),(0,t.jsx)(M.Input,{"aria-label":"Username","data-testid":(0,I.tid)("account","delete-confirm-modal","input-username"),disabled:s,error:m,maxLength:48,onChange:e=>d(e.target.value),value:o})]}),(0,t.jsx)(ef.Spacer,{}),(0,t.jsxs)("label",{children:[(0,t.jsxs)("p",{className:"text-copy-14 m-0",children:["To verify, type ",(0,t.jsx)("b",{children:ek})," below:"]}),(0,t.jsx)(ef.Spacer,{y:1/4}),(0,t.jsx)(M.Input,{"aria-label":"Verification Text","data-testid":(0,I.tid)("account","delete-confirm-modal","input-verify"),disabled:s,error:x,maxLength:ek.length,onChange:e=>u(e.target.value),value:c})]})]})]}),(0,t.jsxs)(L.Modal.Actions,{children:[(0,t.jsx)(L.Modal.Action,{disabled:s,onClick:l,type:"secondary",children:"Cancel"}),(0,t.jsx)(L.Modal.Action,{buttonType:"submit",loading:s,children:"Delete"})]})]})})};function eL(e){let{error:i}=e;if("cannot-delete-own-team"===i.reason&&i.teamDeleteResponse?.reason==="integration-configuration-needs-finalization"){let e=i.teamDeleteResponse.team;return(0,t.jsxs)(c.ErrorText,{children:["The ",e.name," team has marketplace integrations that need to be finalized. Before deleting your account, please uninstall"," ",(0,t.jsx)(b.Link,{href:`/${e.slug}/~/integrations`,tab:!0,type:"highlight",children:"any marketplace integrations"}),"."]})}return(0,t.jsx)(c.ErrorText,{children:i.message})}var e_=e.i(8042625);let eD=e=>{let{reason:i}=e,{user:l}=(0,g.useAccount)();if(!l?.limited)return null;let s=`/login/scope/${encodeURIComponent(l.username)}${(0,e_.encode)({next:location.pathname+location.search,missingScope:"1"})}`;return(0,t.jsx)(eT.Entity,{actions:(0,t.jsx)(b.ButtonLink,{href:s,children:"Re-authenticate"}),children:(0,t.jsxs)(eC.EntityField,{children:["You must re-authenticate to ",i,"."]})})};var eU=e.i(8447830),eR=e.i(1138726),eB=e.i(7017723),ez=e.i(1877305);function eV(){let e=(0,eB.useIsImpersonating)(),[i,l]=(0,a.useState)(!1),s=async()=>{try{l(!0),e||await (0,j.fetchAPI)("/api/dash-tips",{method:"DELETE",throwOnHTTPError:!0}),f.toasts.success("Tips were reset successfully")}catch{f.toasts.error("Failed to reset tips")}finally{l(!1)}};return(0,t.jsxs)(u.Fieldset,{children:[(0,t.jsxs)(d.FieldsetContent,{children:[(0,t.jsx)(ez.FieldsetTitle,{id:P.PERSONAL_ACCOUNT_SETTINGS_NAVIGATION_TITLES.general.resetTips,children:P.PERSONAL_ACCOUNT_SETTINGS_NAVIGATION_TITLES.general.resetTips}),(0,t.jsx)(h.FieldsetSubtitle,{children:"See onboarding tips you might have missed."})]}),(0,t.jsxs)(m.FieldsetFooter,{children:[(0,t.jsx)(m.FieldsetFooter.Status,{children:"Resetting will make all onboarding tips re-appear."}),(0,t.jsx)(m.FieldsetFooter.Actions,{children:(0,t.jsx)(r.Button,{size:"small",onClick:s,loading:i,children:"Reset"})})]})]})}var e$=e.i(5601342);e.s(["AccountSettings",0,function(){let{user:e,isNorthstar:a}=(0,l.useUser)(),{isReady:n,value:r}=(0,s.useEmailNotificationRulesFlag)();return(0,t.jsxs)(t.Fragment,{children:[e?.limited?(0,t.jsx)("section",{className:"jsx-a8f14d46dece53f0",children:(0,t.jsx)(eD,{reason:"edit your User settings"})}):null,(0,t.jsx)("section",{className:"jsx-a8f14d46dece53f0",children:(0,t.jsx)(eu.default,{disabled:void 0,isCreating:void 0,loading:void 0,forceUserContext:!0})}),(0,t.jsx)("section",{className:"jsx-a8f14d46dece53f0",children:(0,t.jsx)(ed.default,{forceUserContext:!0})}),(0,t.jsx)("section",{className:"jsx-a8f14d46dece53f0",children:(0,t.jsx)(ec.SlugFieldset,{forceUserContext:!0})}),(0,t.jsx)("section",{className:"jsx-a8f14d46dece53f0",children:(0,t.jsx)(T,{})}),(0,t.jsx)("section",{id:"email",className:"jsx-a8f14d46dece53f0",children:(0,t.jsx)(Z,{})}),n&&r?(0,t.jsx)("section",{className:"jsx-a8f14d46dece53f0",children:(0,t.jsx)(eo,{})}):null,(0,t.jsx)("section",{id:"phone-number",className:"jsx-a8f14d46dece53f0",children:(0,t.jsx)(e$.PreferencesProvider,{defaultLoaded:!0,children:(0,t.jsx)(eR.default,{usePhoneNumberModal:!1})})}),(0,t.jsx)("section",{className:"jsx-a8f14d46dece53f0",children:(0,t.jsx)(em.IdFieldset,{id:e?.uid,forceUserContext:!0})}),a?null:(0,t.jsx)("section",{className:"jsx-a8f14d46dece53f0",children:(0,t.jsx)(eU.default,{isTeam:!1})}),a?null:(0,t.jsx)("section",{className:"jsx-a8f14d46dece53f0",children:(0,t.jsx)(eh.TransferFieldset,{source:"user-settings"})}),(0,t.jsx)("section",{id:"reset-tips",className:"jsx-a8f14d46dece53f0",children:(0,t.jsx)(eV,{})}),(0,t.jsx)("section",{id:"delete-account",className:"jsx-a8f14d46dece53f0",children:(0,t.jsx)(eF,{})}),(0,t.jsx)(i.default,{id:"a8f14d46dece53f0",children:"section.jsx-a8f14d46dece53f0{margin-bottom:var(--geist-gap-section)}"})]})}],461376)}]);

//# debugId=87a64fcb-23a4-4199-f028-121c9d97d69d
//# sourceMappingURL=8116221102d4221a.js.map